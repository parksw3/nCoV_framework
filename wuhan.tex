\documentclass[12pt]{article}
\usepackage[top=1in,left=1in, right = 1in, footskip=1in]{geometry}

\usepackage{graphicx}
%\usepackage{adjustbox}

\newcommand{\eref}[1]{(\ref{eq:#1})}
\newcommand{\fref}[1]{Fig.~\ref{fig:#1}}
\newcommand{\Fref}[1]{Fig.~\ref{fig:#1}}
\newcommand{\sref}[1]{Sec.~\ref{#1}}
\newcommand{\frange}[2]{Fig.~\ref{fig:#1}--\ref{fig:#2}}
\newcommand{\tref}[1]{Table~\ref{tab:#1}}
\newcommand{\tlab}[1]{\label{tab:#1}}
\newcommand{\seminar}{SE\mbox{$^m$}I\mbox{$^n$}R}

\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}

%\usepackage{lineno}
%\linenumbers

\usepackage[pdfencoding=auto, psdextra]{hyperref}

\usepackage{natbib}
\bibliographystyle{chicago}
\date{\today}

\usepackage{xspace}
\newcommand*{\ie}{i.e.\@\xspace}

\usepackage{color}
\usepackage{xspace}
\newcommand{\Rx}[1]{\ensuremath{{\mathcal R}_{#1}}} 
\newcommand{\Ro}{\Rx{0}\xspace}
\newcommand{\RR}{\ensuremath{{\mathcal R}}}
\newcommand{\Rhat}{\ensuremath{{\hat\RR}}}
\newcommand{\tsub}[2]{#1_{{\textrm{\tiny #2}}}}

\newcommand{\comment}[3]{\textcolor{#1}{\textbf{[#2: }\textsl{#3}\textbf{]}}}

%% \newcommand{\rev}[1]{\comment{red}{REV}{#1}}
\newcommand{\rev}[1]{}

\newcommand{\swp}[1]{\comment{magenta}{SWP}{#1}}
\newcommand{\jd}[1]{\comment{magenta}{JD}{#1}}
\newcommand{\bmb}[1]{\comment{magenta}{BMB}{#1}}
\newcommand{\new}[1]{\textcolor{blue}{#1}}

\begin{document}

\begin{flushleft}{
	\Large
	\textbf\newline{
		Reconciling early-outbreak preliminary estimates of the basic reproductive number: a new framework and applications to the novel coronavirus (2019-nCoV) outbreak
	}
}

\bigskip

% *swp2@princeton.edu
\end{flushleft}

\section*{Abstract}

\pagebreak

\section{Introduction}

Since December 2019, the novel coronavirus (2019-nCoV) has been spreading in China and other parts of the world.
As of January 28th, 2020, the World Health Organization has confirmed 4593 cases, including 56 confirmed cases in 14 different countries, outside China \citep{who28report}.
Although the virus is believed to have originated from animal reservoirs \citep{cdcncov}, 
there is clear evidence that it can be directly transmitted between humans,
posing a greater threat for its spread \citep{huang2020clinical,who26report}.

As the disease continues to spread, many researchers have published analyses of the outbreak, many focusing in particular on estimates of the basic reproductive number \Ro (i.e., the average number of secondary cases generated by a primary case in a fully susceptible population \citep{anderson1991infectious, diekmann1990definition}).
Estimating the basic reproductive number is of interest during an outbreak because it provides information about the level of intervention required to interrupt transmission \citep{anderson1991infectious}, and about the final size of the outbreak \citep{anderson1991infectious, ma2006generality}.
However, it can be difficult to assess the validity of the estimates of \Ro (as well as the associated degrees of uncertainty) when the estimation methods and their underlying assumptions vary widely, especially since these assumptions can directly affect the estimates.

Here, we show that a wide range of approaches to estimating \Ro\ can be understood and compared in terms of estimates for three quantities: the exponential growth rate $r$, the mean generation interval $\bar G$, and the generation-interval dispersion $\kappa$. We suggest that authors should make sure their assumptions about these three quantities are clear and reasonable, and that estimates of uncertainty should propagate error from all three sources. 

We evaluate six disparate models posted online between January 24--26, 2020 that estimated \Ro\ for the 2019-nCoV outbreak. We use our framework to construct pooled estimates for the underlying parameters. We use these pooled estimates to illustrate the importance of propagating different sources of error, particularly uncertainty in both the growth rate and the generation interval. We also use our framework to unravel which assumptions of these different models led to their different estimates and confidence intervals.

\section{Results}

\begin{table}[t]
\begin{center}
\footnotesize
\begin{tabular}{l|l|l|l}
 & Basic reproductive number & Mean generation time & CV$^2$ generation time \\
\hline
Study 1 & 2.5 (1.5--3.5)$^\ast$ & 8.4 days & unspecified$^\dagger$ \\
\hline
Study 2 & 2.92 (95\% CI: 2.28--3.67) & 8.4 days & 0.2 \\
\hline
Study 3 & 3.8 (95\% CI: 3.6--4.0) & 7.6 days & 0.5 \\
\hline
Study 4 & 2.2 (90\% CI: 1.4--3.8) & 7--14 days & 0.5\\
\hline
Study 5 & 5.47 (95\% CI: 4.16--7.10)$^\ddagger$ & 7.6--8.4 days & 0.2\\
\hline
Study 6 & 2.0--3.1 & 6--10 days & 0 \\
\hline
\end{tabular}
\end{center}
\caption{
\textbf{Reported estimates of the basic reproductive number and the assumptions about the generation-interval distributions.}
Estimates of \Ro and their assumptions about the shape of the generation interval distributions were collected from 6 studies.
$^\ast$We treat these intervals as a 95\% confidence interval in our analysis.
$^\dagger$We assume $\kappa = 0.5$ in our analysis.
$^\ddagger$The authors presented \Ro estimates under different assumptions; we use their baseline scenario in our analysis.
}
\end{table}

We gathered information on estimates of \Ro and their assumptions about the underlying generation-interval distributions from 6 articles that were uploaded to preprint servers between January 24th, 2020 and January 26th, 2020 (Table 1).
For each study $i$, we analyze explicitly or implicitly reported distributions of the reproductive number $\mathcal R_{0i}$, the mean generation interval $\bar G_i$, and the generation-interval dispersion parameter $\kappa_i$ (equivalent to the squared coefficient of variation for a Gamma distribution).
We used Gamma distributions to model values reported with confidence intervals and uniform distributions to model values reported with ranges.
For example, Study 2 estimated $\Ro = 2.92$ (95\% CI: 2.28--3.67);
we model this parameter as a Gamma distribution with a mean of 2.92 and a shape parameter of 67, which has a 95\% probability of containing a value between 2.28 and 3.67 (see Table 2 for a complete description).
We then constructed a family of parameter sets for each study, and used these in a Bayesian multilevel model to build a distribution of pooled estimates (see Methods).

\newcommand{\gammdist}{\mathrm{Gamma}}
\begin{table}[t]
\begin{center}
\footnotesize
\begin{tabular}{l|l|l|l}
 & Basic reproductive number & mean generation time (days) & CV$^2$ generation time \\
\hline
Study 1 & $\gammdist(\alpha=28, \beta=28/2.6)$ & constant & constant \\
\hline
Study 2 & $\gammdist(\alpha=67, \beta=67/2.92)$ & constant & constant \\
\hline
Study 3 & $\gammdist(\alpha=1400, \beta=1400/3.8)$ & constant & constant \\
\hline
Study 4 & $\gammdist(\alpha=12, \beta=12/2.2)$ & $\mathrm{Uniform}(7, 14)$ & constant\\
\hline
Study 5 & $\gammdist(\alpha=54, \beta=54/5.47)$ & $\mathrm{Uniform}(7.6, 8.4)$ & constant\\
\hline
Study 6 & N.A.$^\ast$ & $\mathrm{Uniform}(6, 10)$ & constant\\
\hline
\end{tabular}
\end{center}
\caption{
\textbf{Probability distributions for \Ro, $\bar G$, and $\kappa$.}
We use these probability distributions to obtain a probability distribution for the exponential growth rate $r$.
The Gamma distribution is parameterized by shape $\alpha$ and rate $\beta$ parameters.
Constant distributions assume fixed values according to Table 1.
$^\ast$Study 6 effectively fits an exponential curve to the cumulative number of confirmed cases without propagating any statistical uncertainty.
Instead of modeling $\mathcal R_0$ with a probability distribution and recalculating $r$, we use $r=0.114\,\mathrm{days}^{-1}$, which explains all uncertainty in $\mathcal R_0$ they report, when combined with the range of $\bar G$ they consider.
}
\end{table}

\fref{assumption} compares the reported values of the exponential growth rate $r$, mean generation interval $\bar G$, and the squared coefficient of variation (CV) $\kappa$ of the generation-interval distribution from different studies with our pooled estimates ($\mu_r$, $\mu_G$, and $\mu_\kappa$) that we calculate from our multilevel model.
We find that there is a large uncertainty associated with the underlying parameters;
many models rely on stronger assumptions that ignore these uncertainties.
Surprisingly, no studies take into account how the variability in generation intervals (represented by $\kappa$) affects their estimates of \Ro, even though the assumed values range from 0 to 0.5 across different studies.
It is also interesting that none of the six studies explicitly or implicitly assumed an exponentially distributed generation interval (i.e., CV$^2$ equal to 1).

\begin{figure}[t]
\includegraphics[width=\textwidth]{compare_assumption.pdf}
\caption{
\textbf{Comparisons of the reported parameter values with our pooled estimates.}
We inferred point estimates, uniform distributions (shown in orange) or confidence intervals (purple) for each parameter from each study, and combined them into pooled estimates (see text).
Black points and lines: reported parameter values and ranges of uncertainties considered.
Black triangle: we assumed $\kappa=0.5$ for Study 1 as they do not report the parameter values that they used.
Red points and lines: median and 95\% confidence intervals of our pooled estimates.
}
\label{fig:assumption}
\end{figure}

\fref{eff} shows the effects of propagating uncertainty ($\mu_r$, $\mu_G$, and $\mu_\kappa$) in different combinations would affect estimates and CIs for our pooled estimates, which represent a reasonable proxy for the state of knowledge as of 26 January. 
Propagating error from the growth rate (which all but one of the models did) is absolutely crucial. 
Propagating error from the generation interval also has important effects, however.
Once these two are included, the impact of leaving out uncertainty in the dispersion would be small, in this particular example.


\begin{figure}[!ht]
\includegraphics[width=\textwidth]{figure2.pdf}
\caption{
\textbf{Effects of $r$, $\bar G$, and $\kappa$ on the estimates of $\mathcal R_0$.}
We compare estimates of $\mathcal R_0$ under five scenarios that propagate different combinations of uncertainties.
(base): $\mathcal R_0$ estimates based on the median estimates of $\mu_r$, $\mu_G$, and $\mu_\kappa$.
(growth rate): $\mathcal R_0$ estimates based on the the posterior distribution of $\mu_r$ while using median estimates of $\mu_G$ and $\mu_\kappa$.
(GI mean): $\mathcal R_0$ estimates based on the the posterior distribution of $\mu_G$ while using median estimates of $\mu_r$ and $\mu_\kappa$.
(growth rate + GI mean): $\mathcal R_0$ estimates based on the the joint posterior distributions of $\mu_r$ and $\mu_G$ while using a median estimate of $\mu_\kappa$.
(all): $\mathcal R_0$ estimates based on the joint posterior distributions of  $\mu_r$, $\mu_G$, and $\mu_\kappa$.
Vertical lines represent the 95\% confidence intervals.
}
\label{fig:eff}
\end{figure}

We also evaluate the estimates of $\mathcal R_0$ across different studies by 
replacing the their values of $r$, $\bar G$, and $\kappa$ with our pooled estimates ($\mu_r$, $\mu_G$, and $\mu_\kappa$) one at a time and recalculating the basic reproductive number $\mathcal R_0$ (\fref{R0}).
We find that incorporating uncertainties one at a time increases the width of the confidence intervals all but three cases.
We estimate narrower confidence intervals for Study 2 and Study 6 when we use our pooled estimate of the squared CV in generation time $\mu_\kappa$ to recalculate $\mathcal R_0$ because they assume a narrow generation-interval distribution ($\kappa=0.2$ and $0$ respectively);
when higher values of $\kappa$ are used, their estimates of $\mathcal R_0$ become less sensitive to the values of $r$ and $\bar G$, giving narrower confidence intervals.
We estimate narrower confidence intervals for Study 4 when we use our pooled estimate of the mean generation time $\mu_G$ to recalculate $\mathcal R_0$ because the range of uncertainty in the mean generation time $\bar G$ they consider is much wider than ours (\fref{assumption}).

Consistent with our previous observations (\fref{eff}),
we find that accounting for uncertainties in the estimate of $r$ has the largest effect on the estimates of $\mathcal R_0$ (\fref{R0}).
For example, recalculating $\mathcal R_0$ for Study 6 by using our pooled estimate of $r$ gives $\mathcal R_0 = 4.0$ (95\% CI: 2.3--10.1), which is much wider than the range they reported (2.0--3.1).
There are two explanations for this result.
First, even though the exponential growth rate $r$ and the mean generation time $\bar G$ have identical effects on $\mathcal R_0$ under the gamma approximation framework \eref{gamma},
$r$ has a greater overall effect on $\mathcal R_0$ because it is associated with more uncertainty;
the range of the 95\% confidence interval on $\mu_r$ spans over more than a two-fold difference, whereas the range of the 95\% confidence intervals on $\mu_G$ does not.
Second, assuming a fixed generation time ($\kappa=0$) makes the estimate of $\mathcal R_0$ too sensitive to $r$ and $\bar G$ as explained previously.

\begin{figure}[!th]
\includegraphics[width=\textwidth]{compare_R0.pdf}
\caption{
\textbf{Sensitivity of the reported $\mathcal R_0$ estimates with respect to our pooled estimates of the underlying parameters.}
We replace the reported parameter values (growth rate $r$, GI mean $\bar G$, and GI variation $\kappa$) with our corresponding pooled estimates ($\mu_r$, $\mu_G$, and $\mu_\kappa$) one at a time and recalculate $\mathcal R_0$.
The pooled estimate of $\mathcal R_0$ is calculated from the joint posterior distribution of $\mu_r$, $\mu_G$, and $\mu_\kappa$;
horizontal dashed lines represent the 95\% confidence intervals of our pooled estimate of $\mathcal R_0$.
The reported $\mathcal R_0$ estimates (base) have been adjusted to show the approximate 95\% confidence interval using the probability distributions that we defined if they had relied on different measures for parameter uncertainties.
}
\label{fig:R0}
\end{figure}

Finally, we incorporate all uncertainties by using posterior samples for $\mu_r$, $\mu_G$, and $\mu_\kappa$ to recalculate $\mathcal R_0$ and compare it with the reported $\mathcal R_0$ estimates.
We estimate the average $\mathcal R_0$ to be 3.1 (95\% CI: 2.1--5.7).
While our pooled estimate of $\mathcal R_0$ is similar to other reported values, our calculation gives wider confidence intervals than all of them.
This result does not imply that assumptions based on the pooled estimate are too weak;
we believe that this confidence interval accurately reflects the level of uncertainties present in the information that was available when these models were fitted.

\section{Discussion}

Estimating the basic reproductive number $\mathcal R_0$ is crucial for predicting the course of an outbreak and planning intervention strategies.
Here, we used a simple framework \citep{park2019practical} to compare estimates of $\mathcal R_0$ for the novel coronavirus outbreak.
Our results demonstrate the importance of accounting for uncertainties associated with the underlying generation-interval distributions, including with the amount of dispersion in the generation intervals:
although our pooled estimates are relatively insensitive to the estimated uncertainty, our analysis of individual studies shows that assuming too narrow a generation-interval distribution can make the estimate of $\mathcal R_0$ too sensitive to the estimates of the exponential growth rate $r$.

Narrow confidence intervals associated with early estimates of $\mathcal R_0$ partly depend on the statistical approaches used to estimate the exponential growth rate $r$.
Of the six studies that we reviewed, two of them directly fit their models to cumulative number of confirmed cases.
Although the formula for the cumulative curve (e.g., logistic model) is much simpler and familiar to many people, fitting a model to cumulative number of without accounting for problems with the dependent error structure can both bias parameter narrow confidence intervals \citep{ma2014estimating, king2015avoidable}.
Naive fits to cumulative incidence data should be avoided.

We have provided a basis for evaluating and comparing exponential-growth based estimates of \Ro\ in terms of three simple components. We are hopeful that this will provide a guide to understanding and reconciling different estimates early in an epidemic.

\section{Methods}

Early in an outbreak, $\mathcal R_0$ cannot be estimated directly;
instead, $\mathcal R_0$ is often inferred from
the exponential growth rate $r$, which can be estimated reliably from incidence data \citep{mills2004transmissibility, nishiura2009transmission, ma2014estimating}.
Given an estimate of the exponential growth rate $r$ and a distribution $g(\tau)$ of
generation intervals (i.e., the time between when a person become 
infected and that person infects another person \citep{svensson2007note}), the basic reproductive
number can be estimated via the Euler-Lotka equation \citep{wallinga2007generation}:
\begin{equation}
1/\mathcal R_0 = \int \exp(-r\tau) g(\tau) d\tau.
\end{equation}
In other words, estimates of $\mathcal R_0$ must
depend on the assumptions about the
exponential growth rate $r$ and the shape of the generation-interval distribution $g(\tau)$.

Here, we use the gamma approximation framework \citep{mcbryde2009early, nishiura2009transmission, roberts2011early, park2019practical} to (1) characterize the amount of uncertainty present in the exponential growth rates and the shape of the generation-interval distribution and (2) assess the degree to which these uncertainties affect the estimate of $\mathcal R_0$.
Assuming that generation intervals follow a gamma distribution
with the mean $\bar G$ and the squared coefficient of variation (CV$^2$) $\kappa$, 
we have
\begin{equation}
\mathcal R_0 = \left(1 + \kappa r \bar{G}\right)^{1/\kappa}.
\label{eq:gamma}
\end{equation}
This equation demonstrates that a generation-interval distribution
that has a larger mean (higher $\bar{G}$) or is less variable (lower $\kappa$)
will give a higher estimate of $\mathcal R_0$ for the same value of $r$.

For each study, we construct a family of parameter sets by drawing 100,000 random samples from the probability distributions (Table 2) that represent the estimates of $\mathcal R_0$ and the assumed values of $\bar G$ and $\kappa$ and calculating the exponential growth rate $r$ via the inverse of \eref{gamma}:
\begin{equation}
r_i = \frac{{\mathcal R_{0i}}^{\kappa_i} - 1}{\kappa_i \bar{G}_i}.
\end{equation}
This allows us to approximate the probability distributions of the estimated exponential growth rates by each study.

We construct pooled estimates for each parameter ($r$, $\bar G$, and $\kappa$) using a Bayesian multilevel modeling approach, which assumes that the parameters across different studies come from the same gamma distribution:
\begin{equation}
\begin{aligned}
r_i &\sim \gammdist(\mathrm{mean}=\mu_r, \mathrm{shape}=\alpha_r),\\
\bar{G}_i &\sim \gammdist(\mathrm{mean}=\mu_G, \mathrm{shape}=\alpha_G),\\
\kappa_i &\sim \gammdist(\mathrm{mean}=\mu_\kappa, \mathrm{shape}=\alpha_\kappa).\\
\end{aligned}
\end{equation}
We account for uncertainties associated with $r_i$, $\bar G_i$ and $\kappa_i$ (and their correlations), by drawing a random set from the family of parameter sets for each study at each Metropolis-Hastings step;
this approach is analogous to Bayesian methods for analyzing phylogenetic data, which often rely on drawing random samples of phylogenetic trees from a discrete set to account for phylogenetic uncertainty \citep{pagel2004bayesian,bedford2014integrating}.
Since the gamma distribution does not allow zeros, we use $\kappa =0.02$ instead for Study 6.

Weakly informative priors are assumed on the hyperparameters:
\begin{equation}
\begin{aligned}
\mu_r &\sim \gammdist(\mathrm{mean}=1\,\mathrm{week}^{-1},\,\mathrm{shape}=0.1)\\
\mu_G &\sim \gammdist(\mathrm{mean}=1\,\mathrm{week},\,\mathrm{shape}=0.1)\\
\mu_G &\sim \gammdist(\mathrm{mean}=0.5,\,\mathrm{shape}=0.1)\\
(\alpha_r, \alpha_G, \alpha_\kappa) &\sim \gammdist(\mathrm{mean}=1,\,\mathrm{shape}=0.1).
\end{aligned}
\end{equation}
We run 4 parallel Markov Chain Monte Carlo (MCMC) chains that consist of 200,000 burnin steps and 200,000 sampling steps.
Posterior samples are thinned every 400 steps.
Convergence is assessed by ensuring that the Gelman-Rubin statistic is below 1.01 for all hyperparameters \citep{gelman1992inference}.

\bmb{general comments (Daniel may have taken notes on these already):
  \begin{itemize}
  \item try flatter-at-origin priors (e.g. half-Cauchy)?
  \item Stan implementation?
  \item comment on broader uncertainty context (King/Rohani on observation + process error, major reporting irregularities, non-stationarity \ldots)
  \item cite Elderd et al on point estimates??
  \item colorspace package ({\tt scale\_colour\_discrete\_qualitative} or other) for Figure 3?
  \end{itemize}
}

\pagebreak

\bibliography{wuhan}

\end{document}
